<!DOCTYPE html>
<html lang="en">
<head><head>
    <meta name="google-site-verification" content="9vIieCe-Qpd78QOmBl63rGtIVbhY6sYyuxX3j8XWBA4" />
    <meta name="baidu-site-verification" content="LRrmH41lz7" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="数组">
    
    <meta name="keyword"  content="Redis, Go, 微服务, PHP, Git, Bash">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Bash专业笔记(十二)-怀府风的博客 | Arvin&#39;s Blog</title>

    <link rel="canonical" href="/2019/02/post/bash-section-12.html">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>
</head>
</head>

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">怀府小阁</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">首页</a>
                    </li>
                    
                    <li>
                        <a href="/categories/go">go</a>
                    </li>
                    
                    <li>
                        <a href="/categories/java">java</a>
                    </li>
                    
                    <li>
                        <a href="/categories/php">php</a>
                    </li>
                    
                    <li>
                        <a href="/categories/%E5%B7%A5%E5%85%B7">工具</a>
                    </li>
                    
                    <li>
                        <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93">数据库</a>
                    </li>
                    
                    <li>
                        <a href="/categories/%E9%9A%8F%E7%AC%94">随笔</a>
                    </li>
                    

                    
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header{
        background-image: url('/img/head_bg.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                       
                       <a class="tag" href="/tags/bash" title="Bash">
                           Bash
                        </a>
                       
                    </div>
                    <h1>Bash专业笔记(十二)</h1>
                    <h2 class="subheading"></h2>
                    <span  class="meta">Posted by 怀府风 on Friday, February 8, 2019
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

        		
                        <header>
                        <h2>TOC</h2>
                        </header>
                        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#数组">数组</a>
<ul>
<li><a href="#数组赋值">数组赋值</a>
<ul>
<li><a href="#列表赋值">列表赋值</a></li>
<li><a href="#下标赋值">下标赋值</a></li>
<li><a href="#索引赋值">索引赋值</a></li>
<li><a href="#关联数组">关联数组</a></li>
<li><a href="#动态赋值">动态赋值</a></li>
</ul></li>
<li><a href="#访问数组元素">访问数组元素</a>
<ul>
<li><a href="#字符串操作">字符串操作</a></li>
</ul></li>
<li><a href="#修改数组">修改数组</a>
<ul>
<li><a href="#索引修改">索引修改</a></li>
<li><a href="#追加元素">追加元素</a></li>
<li><a href="#插入元素">插入元素</a></li>
<li><a href="#删除元素">删除元素</a></li>
<li><a href="#合并数组">合并数组</a></li>
<li><a href="#重新索引数组">重新索引数组</a></li>
</ul></li>
<li><a href="#数组迭代">数组迭代</a>
<ul>
<li><a href="#迭代命令的输出">迭代命令的输出</a></li>
</ul></li>
<li><a href="#数组长度">数组长度</a></li>
<li><a href="#关联数组-1">关联数组</a>
<ul>
<li><a href="#声明关联数组">声明关联数组</a></li>
<li><a href="#初始化元素">初始化元素</a></li>
<li><a href="#访问关联数组元素">访问关联数组元素</a></li>
<li><a href="#列出数组值">列出数组值</a></li>
<li><a href="#迭代关联数组键值">迭代关联数组键值</a></li>
<li><a href="#关联数组计数">关联数组计数</a></li>
</ul></li>
<li><a href="#循环一个数组">循环一个数组</a></li>
<li><a href="#销毁数组">销毁数组</a></li>
<li><a href="#从字符串获取数组">从字符串获取数组</a></li>
<li><a href="#索引列表">索引列表</a></li>
<li><a href="#从文件读取内容到数组">从文件读取内容到数组</a></li>
<li><a href="#数组插入函数">数组插入函数</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
        		
        		

<h2 id="数组">数组</h2>

<h3 id="数组赋值">数组赋值</h3>

<h4 id="列表赋值">列表赋值</h4>

<p>如果你熟悉Perl，C或者Java的话，你可能会认为Bash使用逗号来分隔数组的元素，然而不是这样的，Bash使用空格来分隔元素：</p>

<pre><code># Perl中的数组
my @array = (1, 2, 3, 4);

#Bash中的数组
array=(1 2 3 4)
</code></pre>

<p>使用新元素创建数组：</p>

<pre><code>array=('first element' 'second element' 'third element')
</code></pre>

<h4 id="下标赋值">下标赋值</h4>

<p>使用明确的元素索引创建一个数组：</p>

<pre><code>array=([3]='fourth element' [4]='fifth element')
</code></pre>

<h4 id="索引赋值">索引赋值</h4>

<pre><code>array[0]='first element'
array[1]='second element'
</code></pre>

<h4 id="关联数组">关联数组</h4>

<p>Version&gt;= 4.0</p>

<pre><code>decalare -A array
array[first]='First element'
array[second]='Second elemet'
</code></pre>

<h4 id="动态赋值">动态赋值</h4>

<p>从其他命令的输出结果创建一个数组，例如使用<code>seq</code>获取1到10的值：</p>

<pre><code>array=(`seq 1 10`)
</code></pre>

<p>从脚本的输入参数赋值给数组：</p>

<pre><code>array=(&quot;$@&quot;)
</code></pre>

<p>使用循环赋值：</p>

<pre><code>while read -r; do
    #array+=(&quot;$REPLY&quot;)  #数组追加
    array[$i]=&quot;$REPLY&quot;  #索引赋值
    let i++             #索引增加
done &lt; &lt;(seq 1 10)      #?

echo ${array[@]} # output: 1 2 3 4 5 6 7 8 9 10
</code></pre>

<p><code>$REPLY</code>总是当期的输入。</p>

<h3 id="访问数组元素">访问数组元素</h3>

<p>打印索引0位置的元素：</p>

<pre><code>echo &quot;${array[0]}&quot;
</code></pre>

<p>Version &lt; 4.3</p>

<p>使用字符串扩展语法打印最后一个元素：</p>

<pre><code>echo &quot;${arr[@]:-1}&quot;
</code></pre>

<p>Version &gt;= 4.3</p>

<p>使用下标语法打印最后一个元素：</p>

<pre><code>echo &quot;${array[-1]}&quot;
</code></pre>

<p>打印所有数组的元素，每个元素单独引用：</p>

<pre><code>echo &quot;${array[@]}&quot;
</code></pre>

<p>打印所有数组元素，使用一个引用：</p>

<pre><code>echo &quot;${array[*]}&quot;
</code></pre>

<p>打印数组从索引1开始的元素，每个元素单独引用：</p>

<pre><code>echo &quot;${array[@]:1}&quot;
</code></pre>

<p>打印数组从索引1开始的3个元素，每个元素单独引用:</p>

<pre><code>echo &quot;${array[@]:1:3}&quot;
</code></pre>

<h4 id="字符串操作">字符串操作</h4>

<p>如果引用单个元素，则允许字符串操作：</p>

<pre><code>array=(zero one two)
echo &quot;${array[0]:0:3}&quot; #输出 zer 字符串zero中0 1 2的字符
echo &quot;${array[0]:1:3}&quot; #输出 ero 字符串zero中1 2 3的字符
</code></pre>

<p>所以<code>${array[$i]:N:M}</code>输出一个字符串从Nth开始(第一个是0)，在字符串<code>${array[$i]}</code>后面的M个元素。</p>

<h3 id="修改数组">修改数组</h3>

<h4 id="索引修改">索引修改</h4>

<p>初始化或者更新数组的一个指定元素：</p>

<pre><code>array[10]=&quot;elevenths element&quot; #因为从0开始
</code></pre>

<p>Version&gt;=3.1</p>

<h4 id="追加元素">追加元素</h4>

<p>修改数组，如果没有指定下标则在数组末尾追加元素：</p>

<pre><code>array+=('fourth element' 'fifth element')
</code></pre>

<p>使用新的元素列表替换数组的所有元素：</p>

<pre><code>array=(&quot;${array[@]}&quot; &quot;fourth element&quot; &quot;fifth element&quot;)
</code></pre>

<p>在数组开始追加元素：</p>

<pre><code>array=(&quot;new element&quot; &quot;${array[@]}&quot;)
</code></pre>

<h4 id="插入元素">插入元素</h4>

<p>在指定位置插入元素：</p>

<pre><code>arr=(a b c d)
#在索引2的位置插入一个元素
i=2
arr=(&quot;${array[@]:0:$i}&quot; 'new' &quot;${array[@]:$i}&quot;)
echo &quot;${array[2]}&quot; #输出 new
</code></pre>

<h4 id="删除元素">删除元素</h4>

<p>使用内建的<code>unset</code>命令删除数组的索引：</p>

<pre><code>arr=(a b c)
echo &quot;${arr[@]}&quot; # outputs: a b c 
echo &quot;${!arr[@]}&quot; # outputs: 0 1 2 
unset -v 'arr[1]'
echo &quot;${arr[@]}&quot; # outputs: a c 
echo &quot;${!arr[@]}&quot; # outputs: 0 2
</code></pre>

<h4 id="合并数组">合并数组</h4>

<pre><code>array3=(&quot;${array1[@]}&quot; &quot;${array2[@]}&quot;)
</code></pre>

<p>对于稀疏数组这个操作也是可以的。</p>

<h4 id="重新索引数组">重新索引数组</h4>

<p>如果元素已从数组中移除，或者您不确定数组中是否存在间隙，则此选项非常有用。重建数组的索引使用：</p>

<pre><code>array=(&quot;${array[@]}&quot;)
</code></pre>

<h3 id="数组迭代">数组迭代</h3>

<p>数组迭代有两种风格，foreach和经典for循环：</p>

<pre><code>a=(1 2 3 4)
#foreach
for y in &quot;${a[@]}&quot;;do
    echo $y
done

#for循环
for((idx=0; idx &lt; ${#a[@]}; idx++)); do
    echo &quot;${a[$idx]}&quot;
done
</code></pre>

<h4 id="迭代命令的输出">迭代命令的输出</h4>

<pre><code>a=($(tr ',' ' ' &lt;&lt;&lt;&quot;a,b,c,d&quot;)) # tr can transform one character to another 
for y in &quot;${a[@]}&quot;; do
	echo &quot;$y&quot; 
done
</code></pre>

<h3 id="数组长度">数组长度</h3>

<p><code>${#array[@]}</code>获取数组<code>${array[@]}</code>的长度：</p>

<pre><code>array=('first element' 'second element' 'third element') 
echo &quot;${#array[@]}&quot; # gives out a length of 3
</code></pre>

<p>这也适用于当个元素的字符串长度：</p>

<pre><code>echo &quot;${#array[0]}&quot; # gives out the lenght of the string at element 0: 13
</code></pre>

<h3 id="关联数组-1">关联数组</h3>

<p>Version&gt;=4.0</p>

<h4 id="声明关联数组">声明关联数组</h4>

<pre><code>declare -A aa
</code></pre>

<p>在初始化或使用之前声明关联数组是必需的。</p>

<h4 id="初始化元素">初始化元素</h4>

<p>你可以像下面这样一次初始化一个元素：</p>

<pre><code>aa[hello]=world
aa[ab]=cd
aa[&quot;key with space&quot;]=&quot;hello world&quot;
</code></pre>

<p>你也可以在一个语句里面初始化一个关联数组：</p>

<pre><code>aa=([hello]=world [ab]=cd [&quot;key with space&quot;]=&quot;hello world&quot;)
</code></pre>

<h4 id="访问关联数组元素">访问关联数组元素</h4>

<pre><code>echo ${aa[hello]} 
# Out: world
echo &quot;${!aa[@]}&quot;
#Out: hello ab key with space
</code></pre>

<h4 id="列出数组值">列出数组值</h4>

<pre><code>echo &quot;${aa[@]}&quot;
#Out: world cd hello world
</code></pre>

<h4 id="迭代关联数组键值">迭代关联数组键值</h4>

<pre><code>for key in &quot;${!aa[@]}&quot;; do
	echo &quot;Key: ${key}&quot;
	echo &quot;Value: ${array[$key]}&quot;
done
# Out:
# Key:   hello
# Value: world
# Key:   ab
# Value: cd
# Key:   key with space
# Value: hello world
</code></pre>

<h4 id="关联数组计数">关联数组计数</h4>

<pre><code> echo &quot;${#aa[@]}&quot; 
 # Out: 3
</code></pre>

<h3 id="循环一个数组">循环一个数组</h3>

<p>我们有下面的数组：</p>

<pre><code>arr=(a b c d e f)
</code></pre>

<p>使用<code>for...in</code>循环：</p>

<pre><code>for i in &quot;${arr[@]}&quot;; do 
	echo &quot;$i&quot;
done
</code></pre>

<p>Version&gt;=2.04</p>

<p>使用类C的<code>for</code>循环：</p>

<pre><code>for ((i=0;i&lt;${#arr[@]};i++)); do 
	echo &quot;${arr[$i]}&quot;
done
</code></pre>

<p>使用<code>while</code>循环：</p>

<pre><code>i=0
while [ $i -lt ${#arr[@]} ]; do
	echo &quot;${arr[$i]}&quot;
	i=$((i + 1)) 
done
</code></pre>

<p>Version&gt;=2.04</p>

<p>使用数字条件的<code>while</code>循环：</p>

<pre><code>i=0
while (( $i &lt; ${#arr[@]} )); do
	echo &quot;${arr[$i]}&quot;
	((i++)) 
done
</code></pre>

<p>使用<code>until</code>循环：</p>

<pre><code>i=0
until [ $i -ge ${#arr[@]} ]; do
	echo &quot;${arr[$i]}&quot;
	i=$((i + 1)) 
done
</code></pre>

<p>Version&gt;=2.04</p>

<p>使用数字条件的<code>until</code>循环：</p>

<pre><code>i=0
until (( $i &gt;= ${#arr[@]} )); do
	echo &quot;${arr[$i]}&quot;
	((i++)) 
done
</code></pre>

<h3 id="销毁数组">销毁数组</h3>

<p>要销毁、删除或取消设置数组：</p>

<pre><code>unset array
</code></pre>

<p>销毁、删除或取消设置数组的一个元素：</p>

<pre><code>unset array[10]
</code></pre>

<h3 id="从字符串获取数组">从字符串获取数组</h3>

<pre><code> stringVar=&quot;Apple Orange Banana Mango&quot; 
 arrayVar=(${stringVar// / })
</code></pre>

<p>字符串中每个空格代表了一个数组中的新元素：</p>

<pre><code>echo ${arrayVar[0]} # will print Apple 
echo ${arrayVar[3]} # will print Mango
</code></pre>

<p>相同的，另外的字符也可以用作分割标识：</p>

<pre><code>stringVar=&quot;Apple+Orange+Banana+Mango&quot; 
arrayVar=(${stringVar//+/ })
echo ${arrayVar[0]} # will print Apple 
echo ${arrayVar[2]} # will print Banana
</code></pre>

<h3 id="索引列表">索引列表</h3>

<p>获取数组的被初始化的所有索引：</p>

<pre><code>$ arr[2]='second'
$ arr[10]='tenth'
$ arr[25]='twenty five' $ echo ${!arr[@]}
2 10 25
</code></pre>

<h3 id="从文件读取内容到数组">从文件读取内容到数组</h3>

<p>所有的操作在一行内：</p>

<pre><code>IFS=$'\n' read -r -a arr &lt; file
</code></pre>

<p>循环中读取文件内容：</p>

<pre><code>arr=()
while IFS= read -r line; do
	arr+=(&quot;$line&quot;) 
done
</code></pre>

<p>Version&gt;=4.0</p>

<p>使用<code>mapfile</code>或<code>readarray</code>（相同的功能）：</p>

<pre><code> mapfile -t arr &lt; file 
 readarray -t arr &lt; file
</code></pre>

<h3 id="数组插入函数">数组插入函数</h3>

<p>下面的函数会在数组指定索引的位置插入一个元素：</p>

<pre><code>insert(){ 
	h='
################## insert ########################
# Usage:
#     insert arr_name index element
#
#     Parameters:
#         arr_name  : Name of the array variable
#         index     : Index to insert at
#         element   : Element to insert
##################################################
	'
	[[ $1 = -h ]] &amp;&amp; { echo &quot;$h&quot; &gt;/dev/stderr; return 1; }
    declare -n __arr__=$1  # reference to the array variable
    i=$2       # index to insert at
	el=&quot;$3&quot;    # element to insert
	# handle errors
	[[ ! &quot;$i&quot; =~ ^[0-9]+$ ]] &amp;&amp; { echo &quot;E: insert: index must be a valid integer&quot; &gt;/dev/stderr; return 1; }
	(( $1 &lt; 0 )) &amp;&amp; { echo &quot;E: insert: index can not be negative&quot; &gt;/dev/stderr; return 1; } 
	# Now insert $el at $i
	__arr__=(&quot;${__arr__[@]:0:$i}&quot; &quot;$el&quot; &quot;${__arr__[@]:$i}&quot;)
}
</code></pre>

<p>使用：</p>

<pre><code> insert array_variable_name index element
</code></pre>

<p>例子：</p>

<pre><code>arr=(a b c d)
echo &quot;${arr[2]}&quot; # output: c
# Now call the insert function and pass the array variable name, 
# index to insert at
# and the element to insert
insert arr 2 'New Element'
# 'New Element' was inserted at index 2 in arr, now print them 
echo &quot;${arr[2]}&quot; # output: New Element
echo &quot;${arr[3]}&quot; # output: c
</code></pre>

<p>参考：<a href="https://goalkicker.com//BashBook/">Bash Notes for Professionals book</a></p>

        
                
        
              <hr>
              <ul class="pager">
                  
                  <li class="previous">
                      <a href="/2019/02/post/git-section-17.html" data-toggle="tooltip" data-placement="top" title="Git专业笔记（十七）">&larr; Previous Post</a>
                  </li>
                  
                  
                  <li class="next">
                      <a href="/2019/02/post/git-section-18.html" data-toggle="tooltip" data-placement="top" title="Git专业笔记（十八）">Next Post &rarr;</a>
                  </li>
                  
              </ul>
  
              
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">特色标签</a></h5>
                    <div class="tags">
                        
                        
                        
                        <a href="/tags/bash" title="bash">
                        bash
                        </a>
                        
                        
                        
                        <a href="/tags/git" title="git">
                        git
                        </a>
                        
                        
                        
                        <a href="/tags/go" title="go">
                        go
                        </a>
                        
                        
                        
                        <a href="/tags/hugo" title="hugo">
                        hugo
                        </a>
                        
                        
                        
                        <a href="/tags/java" title="java">
                        java
                        </a>
                        
                        
                        
                        <a href="/tags/mysql" title="mysql">
                        mysql
                        </a>
                        
                        
                        
                        <a href="/tags/php" title="php">
                        php
                        </a>
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    
                    
                    
                    

                    

		    
                    
                    
                    
                    
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; 怀府小阁 , 2019
                    <br>

                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>




<script>
    
    var _baId = '60e88bb5add74ae0f8d6971f23b916ce';

    
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




</body>
</html>
